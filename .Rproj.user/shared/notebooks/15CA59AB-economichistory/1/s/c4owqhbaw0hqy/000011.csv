"0",""
"0","ITvsCol2 <- rbind(ITvsCol,IncomeTaxData2)"
"0",""
"0","ITvsCol2a <- ITvsCol2 %>%"
"0","            filter(type != 'Nominal GDP' & type != 'Population')"
"0",""
"0","ITvsCol2b <- ITvsCol2 %>%"
"0","             filter(type == 'Nominal GDP')"
"0",""
"0","ITvsCol2b <- ITvsCol2b %>%"
"0","                mutate(mark=NA)"
"0",""
"0","ITvsCol2b$mark[1] <- paste0('$', as.character(round(ITvsCol2b$value[1]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[3] <- paste0('$', as.character(round(ITvsCol2b$value[3]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[5] <- paste0('$', as.character(round(ITvsCol2b$value[5]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[7] <- paste0('$', as.character(round(ITvsCol2b$value[7]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[9] <- paste0('$', as.character(round(ITvsCol2b$value[9]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[11] <- paste0('$', as.character(round(ITvsCol2b$value[11]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[13] <- paste0('$', as.character(round(ITvsCol2b$value[13]/1000000000,digits=2)))"
"0","ITvsCol2b$mark[15] <- paste0('$', as.character(round(ITvsCol2b$value[15]/1000000000,digits=2)))"
"0",""
"0","ggratio2 <- max(TotalReceipts$value/1000000000)/max(ITvsCol2b$value)"
"0",""
"0","ggIncomeTaxData2 <- ggplot(ITvsCol2a,aes(x=date,y=value,fill=type)) +"
"0","                    geom_col() +"
"0","                    geom_line(data=ITvsCol2b,"
"0","                              aes(y=value/max(value)*max(TotalReceipts$value/1000000000)),"
"0","                              size=2,"
"0","                              color = 'black'"
"0","                              ) +"
"0","                    scale_y_continuous(name=""Tax Revenue in $B"","
"0","                                       breaks=seq(0,max(TotalReceipts$value/1000000000)+1.5,by=1),"
"0","                                       labels=scales::dollar_format(accuracy=.1),"
"0","                                       sec.axis ="
"0","                                       sec_axis(trans=~./max(TotalReceipts$value)*max(ITvsCol2b$value),"
"0","                                                name=""Nominal GDP in $B"","
"0","                                                labels=scales::dollar_format(accuracy=.1),"
"0","                                                breaks=seq(0,max(ITvsCol2b$value/1000000000),by=20)),"
"0","                                       ) +"
"0","                    scale_x_continuous(name=""Years of the Great Depression"","
"0","                                       breaks=seq(min(ITvsCol$date),max(ITvsCol$date),by=2),"
"0","                                       ) +"
"0","                    ggtitle(""Figure 2: U.S. Federal Government Revenue from 1927-1941,"
"0","                            with GDP"") +"
"0","                    guides(fill=guide_legend(title='')) +"
"0","                    theme(legend.position=""right"","
"0","                          panel.grid.major = element_blank(),"
"0","                          panel.grid.minor = element_blank(),"
"0","                          panel.background = element_blank(),"
"0","                          axis.line = element_line(colour = ""black""),"
"0","                          ) +"
"0","                    scale_fill_manual(values=c(""#640000"", ""#00B0F0"",'black'),"
"0","                                      breaks=c('Income Tax Revenue','Other Tax Revenue','Nominal GDP')) +"
"0","                    geom_label(data=ITvsCol2b,"
"0","                               aes(y = value*ggratio2+.4,"
"0","                               label = mark,),"
"0","                               nudge_x = 0, size = 3,"
"0","                               fill = 'gray',"
"0","                               )"
"0",""
"0",""
"0",""
"0",""
"0","ggIncomeTaxData2"
"0",""
