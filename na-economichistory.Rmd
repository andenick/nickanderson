---
title: "Economic History"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 1
    #code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
```

```{r, include = F, echo = F}
require('readxl')
require('tidyverse')
require('formattable')
require('directlabels')
#install.packages('readxl')
#install.packages('tidyverse')
#install.packages('formattable')
#install.packages('directlabels')
library(readxl)
library(tidyverse)
library(formattable)
library(directlabels)
remove(list = ls())
#now I am going to read the excel sheet I need into the RMarkdown for graphing
IncomeTaxData <- read_excel('C:\\Users\\anden\\Dropbox\\Data Science\\web Tax Revenue Cyclicality\\IncomeTaxData_NA.xlsx', sheet="RExport")
IncomeTaxData2 <- read_excel('C:\\Users\\anden\\Dropbox\\Data Science\\web Tax Revenue Cyclicality\\IncomeTaxData_NA.xlsx', sheet="RExport1")

#IncomeTaxData$Year <- ymd(IncomeTaxData$Year,truncated=2L)
#IncomeTaxData$Year <- update(IncomeTaxData$Year, month = 6, mday = 30)

#??toc

```


# Tax Revenue Cyclicality

## Tax Revenue Cyclicality: The U.S. Example 1800-2020

By Nick Anderson

Dated 2022.01.07

### Abstract

This paper investigates the correlation between cyclicality and federal tax revenue in the United States. From the Funding Act of 1790, the United States has evolved alongside its tax system. After relying heavily on Customs Duties and Excise Taxes from 1790 to 1913, the United States turned to the Income Tax as its primary funding mechanism. Are these funding mechanisms procyclical or countercyclical? Can procyclical funding mechanisms reliably fund countercyclical fiscal policy? 

### Introduction

  Countercyclical fiscal policy was a cornerstone of the Keynesian revolution in economics. Keynes emphasized that, in economic downturns, governments who imposed austerity and cut spending only worsened their recessions by decreasing the level of aggregate demand. Thus, governments should respond to downturns with stimulus, spending against the cycle. To fund (or pay down the debt from) this stimulus, governments would run a surplus in upturns.
  The complication in the above policy prescription lies in the nature of the income tax. By the publication of Keynes’ General Theory in 1936, the income tax was a vital funding mechanism for the United States and United Kingdom, among many other countries. Because income taxes are earned by the government only when taxable incomes are earned, income taxes are inherently procyclical. This paper grew out of the author’s attempt to test the strength of the income tax’s cyclicality in U.S. history. 
  The starkest example of the income tax’s cyclicality occurred in the Great Depression. As unemployment increased to as high as 24% in 1933, U.S. income tax revenues fell over 60% (Figure 1). In the years of greatest revenue need, income tax revenues almost disappeared. 

```{r, echo = F}

#GDP <- 
IncomeTaxvs <- IncomeTaxData %>%
               select(Year,'Total Receipts') %>% 
               mutate(id='Total Receipts') %>%
               rename("type" = "id",
                      "value" = "Total Receipts",
                      "date" = "Year")

IncomeTaxvs1 <- IncomeTaxData %>%
               select(Year,'Not Income Tax') %>%
               mutate(id='Other Tax Revenue') %>%
               rename("type" = "id",
                      "value" = "Not Income Tax",
                      "date" = "Year")

IncomeTaxvs2 <- IncomeTaxData %>%
               select(Year,'Income Tax') %>% 
               mutate(id='Income Tax Revenue') %>%
               rename("type" = "id",
                      "value" = "Income Tax",
                      "date" = "Year")

IncomeTaxvs3 <- IncomeTaxData %>%
               select(Year,'Unemployment Rate') %>% 
               mutate(id='Unemployment Rate') %>%
               rename("type" = "id",
                      "value" = "Unemployment Rate",
                      "date" = "Year")

ITvs <- rbind(IncomeTaxvs,IncomeTaxvs1) 
ITvs <- rbind(ITvs,IncomeTaxvs2)
ITvs <- rbind(ITvs,IncomeTaxvs3)

ITvsCol <- ITvs %>%
           filter(type != 'Total Receipts') %>%
           filter(type != 'Unemployment Rate') %>%
           mutate(value = value/1000000000)

IncomeTaxvs3 <- IncomeTaxvs3 %>%
                mutate(mark=NA)


IncomeTaxvs3$mark[1] <- paste0(as.character(IncomeTaxvs3$value[1]*100), '%')
IncomeTaxvs3$mark[3] <- paste0(as.character(IncomeTaxvs3$value[3]*100), '%')
IncomeTaxvs3$mark[5] <- paste0(as.character(IncomeTaxvs3$value[5]*100), '%')
IncomeTaxvs3$mark[7] <- paste0(as.character(IncomeTaxvs3$value[7]*100), '%')
IncomeTaxvs3$mark[9] <- paste0(as.character(IncomeTaxvs3$value[9]*100), '%')
IncomeTaxvs3$mark[11] <- paste0(as.character(IncomeTaxvs3$value[11]*100), '%')
IncomeTaxvs3$mark[13] <- paste0(as.character(IncomeTaxvs3$value[13]*100), '%')
IncomeTaxvs3$mark[15] <- paste0(as.character(IncomeTaxvs3$value[15]*100), '%')

#ITvsCol2 <- rbind(ITvsCol,IncomeTaxvs3)
#str(IncomeTaxvs)

#ITvsCol$type <- relevel()

ggratio1 <- (max(IncomeTaxvs$value/1000000000))/max(IncomeTaxvs3$value)

ggIncomeTaxData <- ggplot(ITvsCol,aes(x=date,y=value,fill=type)) +
                   geom_col() +
                   scale_y_continuous(name="Dollars (in Billions)",
                                      breaks=seq(0,max(IncomeTaxvs$value/1000000000)+1.5,by=1),
                                      labels=scales::dollar_format(accuracy=.1),
                                      sec.axis =
                                      sec_axis(
                                        trans=~./max(IncomeTaxvs$value/1000000000)*max(IncomeTaxvs3$value),
                                                          name="% Unemployment Rate",
                                                          labels = scales::label_percent()),
                                      ) +
                   scale_x_continuous(name="Years of the Great Depression",
                                      breaks=seq(min(ITvsCol$date),max(ITvsCol$date),by=2),
                                      ) +
                   ggtitle("Figure 1: U.S. Federal Government Revenue from 1927-1941, 
                           with Unemployment Rate") +
                   guides(fill=guide_legend(title='')) +
                   scale_fill_manual(values=c("#640000", "#00B0F0",'black')) +
                   theme(legend.position="right",
                         panel.grid.major = element_blank(), 
                         panel.grid.minor = element_blank(),
                         panel.background = element_blank(), 
                         axis.line = element_line(colour = "black"), 
                         ) +
                   geom_line(data=IncomeTaxvs3,
                             aes(y=value*ggratio1),
                             linewidth=2,
                             ) +
                   geom_label(data=IncomeTaxvs3,
                              aes(y = value*ggratio1+.4,
                                  label = mark,), 
                              nudge_x = 0.35, size = 3,
                              fill = 'gray',
                             ) 
                   

ggIncomeTaxData

#?geom_dl
#?scales::percent
#?scales::label_percent()
#?geom_hline
#?geom_label

#panel.border = element_rect(color = "black", fill=NA, size = 3),
# panel.grid.major.y = element_line(color = "black", size = 0.1, linetype = 2)


```

Source: Lebergott 1957 (he was with the NBER) and the BLS (My Data)LINK

The Great Depression remains the severest example of economic depression available for examination. The author emphasizes this example not as conclusive proof, but as a demonstration of income tax revenue procyclicality.

The ‘business cycle’ is not easy to define, so this paper examines two aspects of cyclicality: Gross Domestic Product (as a measure of incomes) and the Unemployment Rate (as a measure of employment). The graph above replicated with Nominal GDP instead of the unemployment rate tell the similar stories from different perspectives (Figure 2). When aggregate demand contracts, the income tax contracts as well.


```{r, echo = F}

ITvsCol2 <- rbind(ITvsCol,IncomeTaxData2)

ITvsCol2a <- ITvsCol2 %>%
            filter(type != 'NGDP' & type != 'Population')

ITvsCol2b <- ITvsCol2 %>%
             filter(type == 'NGDP') 



#ITvsCol2b[1] <- ITvsCol2b[1]/10

ggIncomeTaxData2 <- ggplot(ITvsCol2a,aes(x=date,y=value,fill=type)) +
                   geom_col() +
                   geom_line(data=ITvsCol2b,
                             aes(y=value/max(value)*max(IncomeTaxvs$value/1000000000)),
                             size=2, 
                             ) +
                   scale_y_continuous(name="Tax Revenue in $B",
                                      breaks=seq(0,max(IncomeTaxvs$value/1000000000)+1.5,by=1),
                                      labels=scales::dollar_format(accuracy=.1),
                                      sec.axis =
                                      sec_axis(
                                        trans=~./max(IncomeTaxvs$value)*max(ITvsCol2b$value),
                                                          name="Nominal GDP in $B",
                                                          labels=scales::dollar_format(accuracy=.1)),
                                      ) +
                   scale_x_continuous(name="Years of the Great Depression",
                                      breaks=seq(min(ITvsCol$date),max(ITvsCol$date),by=2),
                                      ) +
                   ggtitle("Figure 1: U.S. Federal Government Revenue from 1927-1941, 
                           with Unemployment Rate") +
                   guides(fill=guide_legend(title='')) +
                   theme(legend.position="right",
                         panel.grid.major = element_blank(), 
                         panel.grid.minor = element_blank(),
                         panel.background = element_blank(), 
                         axis.line = element_line(colour = "black"), 
                         ) + 
                   scale_fill_discrete(breaks=c('Income Tax Revenue','Other Tax Revenue','NGDP'))

?scale_fill_discrete

ggIncomeTaxData2

```

### Data

  Data collection and cleaning proved the most difficult portion of this paper. FRED timeseries data for GDP, unemployment, and the federal budget all cut out between 1929 and 1999, requiring alternative data sources for further historical investigation. 
  
  Each data set is described below:  
  
1.	**Tax Revenue (1792-2020)**: Hungerford (2006) provides a great foundation for comprehensive datasets of US Federal Government Revenues. In a Congressional Research Service report, he compiles a dataset of Federal Revenues from 1820-2005 from three sources. Though one of these sources is unavailable to the public, the included Office of Management and Budget’s Historical Tables’ 2020 update has detailed revenue data from 1934 to 2020. There is some included data going back to 1789, but without component totals (income, excise, customs, etc.) and in some cases not annual data. For earlier data, Hungerford (2006) reached back to Lillian Doris’ The American Way in Taxation: Internal Revenue 1862-1963, which included specific data on income taxes and excise taxes from 1820-1962 but lacked other sources of revenue and left our dataset incomplete. Fortunately, the 1949 Historical Statistics of the United States 1789-1945 includes detailed annual totals from 1792 to 1945, which bridges the gap in this dataset. This paper’s final tax revenue dataset is 1792-1944 from Historical Statistics of the United States 1789-1945 and 1945-2020 from Office of Management and Budget (2022).

2.	**Gross Domestic Product (1792-2020)** : This paper’s first proxy for cyclicality is Gross Domestic Product. The collaborative work of Johnston and Williamson (2022) on measuringworth.com aggregated data from Kuznets et. al up to 1929 and uses the Bureau of Economic Analysis’ current estimates from 1929 to 2020. This paper utilizes the Johnston and Williamson (2022) dataset for the years 1792-2020.

3.	**Unemployment (1900-2020)**: The second proxy for cyclicality is the unemployment rate. FRED unemployment data is monthly and only reaches back to January 1948, so for any pre-war data another source is needed. Lebergott (1957) combines estimates from 1900-1928, Monthly Labor Review data for 1929-1939, and data through 1954 from the Bureau of the Census. This paper’s final unemployment dataset includes 1900-1948 from Lebergott (1957) and FRED’s estimates from 1948-2020 (UNRATENSA).


### Tax History

  The history of taxation in the United States can be split into four eras: 

1.	**Customs Duties Era (1790-1862)**: The era before 1862 is the era of Customs Duties. Another feature of this era is the sporadic use of Sale of Public Land to raise revenue. 

2.	**Excise Tax Era (1862-1913)**: The establishment of the IRS in 1862 allowed for Excise and Income taxation, though the Income Tax was repealed in 1872. This marks the second era between 1862 and 1913, where the Excise Tax and Customs Duties combined for more than 90% of Federal Government Revenues. 

3.	**Income Tax Era (1913-1945)**: After being deemed unconstitutional in 1892, the Income Tax was reestablished in 1913 when Wilson’s administration signed the 16th Amendment into law. The period between 1913 and The Income Tax does not remain above 50% of federal revenues until World War II. These dates distinguish the third era, in which two wars and a Great Depression occur.

4.	**Decline of Income Tax Era (1945-Present)**: The undercurrent of the Income Tax Era is the onset and growth of Social Insurance and Retirement Taxes, or Payroll Taxes. After reaching over 80% of federal government revenue in 1945, the Income Tax enters a slow decline as Payroll Taxes grew from 8% of revenues in 1945 to over 40% revenues in 2004. This paper was written in the fourth era.
The data for Figure 3 below uses the methodology and data from Hungerford (2006). His CRS report summarized US Tax History into three phases instead of four, combining this paper’s two eras of Income Tax dominance into a single Income Tax Era. 

```{r}

```


### Analysis

  This paper’s method relies on a simple decade by decade calculation of correlation between the measure of cyclicality (GDP or Unemployment Rate) and Tax Revenue by Source.
  
```{r}

```

  This first Figure 4 provides a two-century overview of the U.S. Federal Government’s Total Receipts’ 10-Year Correlation with Nominal GDP. In the initial 1800-1820, Total Receipts had a negligibly or negatively correlated relationship with Nominal GDP. For the remainder of U.S. history, Total Receipts remains positively correlated with Nominal GDP. 
  
```{r}

```
  
  Compare Figure 4 to Figure 5. The annual growth of the Unemployment Rate is negatively correlated with Total Receipts over the sample period 1910-2020. Because the Unemployment Rate would increase in a downturn, this again is evidence that U.S. tax revenue is procyclical. Let’s compare these two indicators to the specific types of taxes observed.
  
```{r}

```
  
  First, is the income tax correlated with GDP or changes in the Unemployment Rate? Figure 6 displays the negative of the Income Tax vs Unemployment Rate, which means that the positive displayed values are the result of a negative correlation with Unemployment Rate. This graph confirms the author’s hypothesis. The Income Tax maintains a procyclical orientation towards Nominal GDP and Unemployment Rate. To be specific, the Income Tax is positively correlated with Nominal GDP and negatively correlated with the Unemployment Rate. 
  
  
  

```{r, echo = F}
# d <- data.frame(
#   y=c(0.1, 0.2, 0.7),
#   cat = factor(c('No', 'Yes', 'NA'), levels = c('NA', 'Yes', 'No')))
# 
# # Original order
# p1 <- ggplot(d, aes(x=1, y=y, fill=cat)) +
#   geom_bar(stat='identity')
# 
# # Change order of rows
# p2 <- ggplot(d[c(2, 3, 1), ], aes(x=1, y=y, fill=cat)) +
#   geom_bar(stat='identity')
# 
# # Change order of levels
# d$cat2 <- relevel(d$cat, 'Yes')
# p3 <- ggplot(d, aes(x=1, y=y, fill=cat2)) +
#   geom_bar(stat='identity') 
# 
# grid.arrange(p1, p2, p3, ncol=3)
```


# Second Project

```{r, echo = F}
samples <- rnorm(100, mean=0, sd=1)
hist(samples)
```


# IRS Data


2018 | 7 | 23 Last compiled: `r Sys.Date()`





<style type="text/css">
.title {
  display: none;
}

.navbar-default {
    background-color: #640000 !important;
    
}

<!-- .navbar-nav { -->
<!--   color:white !important; -->

<!-- } -->

.navbar .navbar-brand, .navbar .navbar-nav .nav-links  {
  color: white;
}

.navbar-default .navbar-nav>li>a {
    color: white !important;
    font-weight: 150;
}

.navbar-nav > .active > a { 
    background-color: #006400 !important;
    font-weight: 175;
}

#getting-started img {
  margin-right: 10px;
  margin-left: 5px;
}


</style>

<div class="row" style="padding-top: 30px;">
<div class="col-sm-6">
